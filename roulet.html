<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BOZHEMAN ROULETTE</title>
  <link rel="stylesheet" href="roulette.css">
</head>
<body>
  <!-- ===== HEADER / BALANCE BAR ===== -->
  <header class="top-bar">
    <h1>ROULETTE&nbsp;OF&nbsp;BOZHEMAN</h1>
    <div class="balance">–ë–∞–ª–∞–Ω—Å: <span id="balance">0</span> BMAN</div>
  </header>

  <!-- ===== MAIN LAYOUT ===== -->
  <div class="layout">
    <!-- WHEEL + BALL -->
    <div class="wheel-wrapper">
      <div class="pointer"></div>
      <div class="wheel" id="wheel">
        <!-- wheel numbers injected here -->
      </div>
      <div class="ball" id="ball"></div>
    </div>

    <!-- BET BOARD (numbers 0‚Äë36 + outside bets) -->
    <div class="bet-board" id="bet-board"></div>
  </div>

  <!-- RESULT & MESSAGE -->
  <div class="number-display" id="result-display"></div>
  <div class="message" id="message"></div>
  <button id="buy-access" class="buy-access" onclick="window.location.href='https://t.me/bozheman';">üíé –ö–£–ü–ò–¢–¨ –ü–†–û–•–û–î</button>

  <!-- CHIP ROW -->
  <div class="chip-row" id="chip-row">
    <!-- chips generated in JS -->
  </div>

  <!-- HISTORY -->
  <div id="history-log" class="history-log"></div>

  <!-- ================== SCRIPTS ================== -->
  <script>
  /* ---------- STATE ---------- */
  let balance = parseInt(localStorage.getItem('bman_balance')) || 100;
  let isSpinning = false;
  let currentRotation = 0;
  let spinCount = 0;
  let selectedChip = 1; // default chip value
  const history = [];

  /* ---------- UI ELEMENTS ---------- */
  const balanceSpan = document.getElementById('balance');
  const wheelEl = document.getElementById('wheel');
  const ballEl  = document.getElementById('ball');
  const betInput= document.createElement('input'); // hidden, used internally
  let choice = '';

  updateBalance();

  /* ---------- BUILD WHEEL ---------- */
  const numbers = Array.from({length:37},(_,i)=>i);
  const colors  = ['green',...numbers.slice(1).map(n=>n%2===0?'black':'red')];
  numbers.forEach((num,i)=>{
    const div=document.createElement('div');
    div.className='wheel-number';
    div.textContent=num;
    div.style.transform=`rotate(${i* (360/37)}deg) translateY(-135px)`;
    div.style.color=colors[i];
    wheelEl.appendChild(div);
  });

  /* ---------- BUILD BET BOARD ---------- */
  const board = document.getElementById('bet-board');
  // outside bets row
  const outsideRow=document.createElement('div');outsideRow.className='outside-row';
  ['red','black','even','odd'].forEach(type=>{
    const cell=document.createElement('div');cell.className='outside-cell';cell.dataset.type=type;
    cell.textContent=type.toUpperCase();
    cell.addEventListener('click',()=>selectChoice(type));
    outsideRow.appendChild(cell);
  });
  board.appendChild(outsideRow);
  // numeric grid 3√ó12 + zero column
  const grid=document.createElement('div');grid.className='number-grid';
  numbers.forEach(num=>{
    const cell=document.createElement('div');
    cell.className='num-cell';
    cell.dataset.num=num;
    cell.textContent=num;
    if(num===0) cell.classList.add('green');
    else cell.classList.add(num%2===0?'black':'red');
    cell.addEventListener('click',()=>selectChoice(num.toString()));
    grid.appendChild(cell);
  });
  board.appendChild(grid);

  /* ---------- BUILD CHIP ROW ---------- */
  const chipRow = document.getElementById('chip-row');
  [1,5,10,50,250].forEach(val=>{
    const chip=document.createElement('div');
    chip.className='chip';
    chip.dataset.value=val;
    chip.textContent=val;
    chip.addEventListener('click',()=>selectChip(val,chip));
    chipRow.appendChild(chip);
  });
  // select first chip
  chipRow.firstChild.classList.add('active');

  function selectChip(val,el){
    selectedChip=val;
    document.querySelectorAll('.chip').forEach(c=>c.classList.remove('active'));
    el.classList.add('active');
  }

  function selectChoice(val){
    choice=val.toString().toLowerCase();
    // place miniature chip on chosen cell
    const target=event.currentTarget;
    const mini=document.createElement('span');
    mini.className='mini-chip';
    mini.textContent=selectedChip;
    target.innerHTML='';
    target.appendChild(mini);
  }

  /* ---------- BALANCE ---------- */
  function updateBalance(){
    balanceSpan.textContent=balance;
    localStorage.setItem('bman_balance',balance);
    document.getElementById('buy-access').style.display=balance>=1000?'inline-block':'none';
  }

  /* ---------- SPIN ---------- */
  function spin(){
    if(isSpinning||!choice) return alert('–°–¥–µ–ª–∞–π —Å—Ç–∞–≤–∫—É!');
    isSpinning=true;spinCount++;
    const bet=selectedChip;
    if(bet>balance){alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤');isSpinning=false;return;}
    balance-=bet;updateBalance();

    const resultNum=Math.floor(Math.random()*37);
    const sector=360/37;
    const extra=720; // 2 –æ–±–æ—Ä–æ—Ç–∞
    const stopAngle=360-resultNum*sector+sector/2;
    currentRotation+=extra+stopAngle;
    wheelEl.style.transition='transform 6s cubic-bezier(0.15,0.7,0.3,1)';
    wheelEl.style.transform=`rotate(${currentRotation}deg)`;

    // Ball opposite direction, slower, ends at result
    const ballRot=currentRotation-extra*0.4;
    ballEl.style.transition='transform 6s linear';
    ballEl.style.transform=`rotate(${-ballRot}deg)`;

    setTimeout(()=>{
      const color=resultNum===0?'green':resultNum%2===0?'black':'red';
      document.getElementById('result-display').textContent=`–í—ã–ø–∞–ª–æ: ${resultNum} (${color})`;
      let win=0;
      if((choice==='b'&&color==='black')||(choice==='r'&&color==='red')||(choice==='g'&&resultNum===0)||
         (choice==='x'&&resultNum%2===1)||(choice==='xx'&&resultNum!==0&&resultNum%2===0)||
         (choice==='red'&&color==='red')||(choice==='black'&&color==='black')||
         (choice==='even'&&resultNum!==0&&resultNum%2===0)||(choice==='odd'&&resultNum%2===1)||
         (!isNaN(parseInt(choice))&&parseInt(choice)===resultNum)){
        if(['g','red','black','even','odd','b','r','x','xx'].includes(choice)) win=bet*2;
        else win=bet*36;
      }
      if(win>0){balance+=win;document.getElementById('message').textContent=`–¢—ã –≤—ã–∏–≥—Ä–∞–ª ${win} BMAN!`;}
      else document.getElementById('message').textContent='–¢—ã –ø—Ä–æ–∏–≥—Ä–∞–ª. –ü–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞.';
      // history
      history.unshift(`#${spinCount}: ${resultNum} (${color}) ‚Äî ${win?'+':'-'}${win||bet}`);
      if(history.length>10)history.pop();
      document.getElementById('history-log').innerHTML=history.map(h=>`<div>${h}</div>`).join('');
      updateBalance();
      // reset board chips
      document.querySelectorAll('.num-cell,.outside-cell').forEach(c=>c.innerHTML=c.dataset.num||c.dataset.type.toUpperCase());
      choice='';
      isSpinning=false;
    },6000);
  }
  // expose spin to button (used in HTML)
  window.spin=spin;
  </script>
</body>
</html>